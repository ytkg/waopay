<script>
  $(function(){
    $('#qrcode_amount').change(function(){
      amount = parseInt($(this).val())
      if (amount < 1) {
        $(this).val('');
        $('#makeButton').prop('disabled', true)
      } else if (amount >= 1000000) {
        $(this).val('999999');
        $('#makeButton').prop('disabled', false)
      } else {
        $(this).val(amount);
        $('#makeButton').prop('disabled', false)
      }
      console.log(amount);
    });
  });
</script>

<h3 class='mt-2'>QR表示</h3>
<div class='text-center'>
  <%= form_for :qrcode, url: qrcode_path, method: :get, remote: true, html: { class: 'form-signin' } do |f| %>
    <div class='form-group'>
      <%= f.label :amount, 'リクエスト金額を入力' %>
      <div class='input-group'>
        <%= f.number_field :amount, class: 'form-control' %>
        <div class="input-group-append">
          <div class="input-group-text">円</div>
        </div>
      </div>
    </div>
    <%= f.submit 'QRコードを表示', id: 'makeButton', class: 'btn btn-primary btn-block', disabled: true, data: { disable_with: 'QRコード生成中' } %>
  <% end %>
</div>

<!-- Button trigger modal -->
<button type="button" id='openModalButton' class="btn btn-primary" data-toggle="modal" data-target="#qrcodeModalCenter" style="display:none">
  Launch demo modal
</button>

<!-- Modal -->
<div class="modal fade" id="qrcodeModalCenter" tabindex="-1" role="dialog" aria-labelledby="qrcodeModalCenterTitle" aria-hidden="true">
  <div class="modal-dialog modal-dialog-centered" role="document">
    <div class="modal-content">
      <div class="modal-header">
        <h5 class="modal-title" id="qrcodeModalCenterTitle">QRコード</h5>
        <button type="button" class="close" data-dismiss="modal" aria-label="Close">
          <span aria-hidden="true">&times;</span>
        </button>
      </div>
      <div class="modal-body text-center">
        <div class='qrcode'></div>
        <div class='amount'></div>
      </div>
      <div class="modal-footer">
        <button type="button" class="btn btn-secondary" data-dismiss="modal">閉じる</button>
      </div>
    </div>
  </div>
</div>
